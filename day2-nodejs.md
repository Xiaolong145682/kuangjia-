# [阻塞和非阻塞]()  

阻塞I/O的一个特点是调用之后一定要等到系统内核层面完成所有扣件操作后, 调用才结束. 例如: 读取磁盘上的一段文件为例, 系统内核在完成磁盘寻道, 读取数据, 复制数据到内存中之后, 这才调用完结束. 阻塞 I/O 造成 CPU 等待 I/O, 浪费等待时间, CPU 的处理能力不能得到充分利用. 为了提高性能, 内核提供了非阻塞 I/O. 非阻塞 I/O 和阻塞 I/O 的差别为调用之后会立即返回.

![](http://nts.newbieol.com/static/k6/51.Node.js/class-002/images/io1.png)
![](http://nts.newbieol.com/static/k6/51.Node.js/class-002/images/io2.png)

## 异步IO
异步式 I/O就是少了多线程的开销。对操作系统来说，创建一个线程的代价是十分昂贵的， 需要给它分配内存、列入调度，同时在线程切换的时候还要执行内存换页，CPU 的缓存被 清空，切换回来的时候还要重新从内存中读取信息，破坏了数据的局部性。  
例如: 我们中午去 KFC 要吃汉堡, 我们点了汉堡以后, 厨师就会我们做汉堡. 餐厅人更加人性话了, 只需要告诉厨师我们电话码号, 然后我们可以去买东西, 当厨师做好后, 会将汉堡放到餐桌上, 然后电话通知道我们. 我们再到餐厅吃午饭.
![](http://nts.newbieol.com/static/k6/51.Node.js/class-002/images/diff.png)
## Nodejs的事件循环机制
Node.js 程序由事件循环开始,到事件循环结束,所有的逻辑都是事件的回调函数,所以 Node.js 始终在事件循环中,程序入口就是事件循环第一个事件的回调函数。事件的回调函数在执行的过程中,可能会发出 I/O 请求或 直接发射(emit)事件,执行完毕后再返回事件循环,事件循环会检查事件队列中有没有未处理的事件,直到程序结束。
![](http://nts.newbieol.com/static/k6/51.Node.js/class-002/images/event.png)
